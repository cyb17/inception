user www-data;
worker_processes auto;
pid /run/nginx.pid;

events {
    worker_connections  1024;
}

http {

	sendfile on;
	tcp_nopush on;
	types_hash_max_size 2048;
	include /etc/nginx/mime.types;
	default_type text/html;

	# ssl configurations
	ssl_protocols TLSv1.2 TLSv1.3;
	ssl_prefer_server_ciphers on;
	ssl_ciphers HIGH:!aNULL:!MD5;

	# ces 2 directives reduisent le nb d'operation SSL handshake
	# pour optimiser le server
	ssl_session_cache shared:SSL:10m;
	ssl_session_timeout 10m;

    server {
		listen 443 ssl;
		listen [::]:443 ssl;
		server_name     localhost;

		root    /var/www/wordpress;
		index index.php index.html index.htm;

		ssl_certificate     /etc/ssl/certs/cert.pem;
		ssl_certificate_key /etc/ssl/private/key.pem;

		location / {
			try_files $uri $uri/ =404;
		}	
		location ~ \.php$ {
		    include snippets/fastcgi-php.conf;
		    fastcgi_pass  wordpress:9000;
		}
    }
}